
- command: 'toolkit:install-dump'
  configuration: []
  expectations:
    - contains: |
        [Simulator] Simulating ExecStack()
          ->stopOnFail()
          ->exec('./vendor/bin/drush sql-drop -y')
          ->exec('./vendor/bin/drush sqlc < dump.sql')
          ->exec('./vendor/bin/drush updatedb -y')
          ->exec('./vendor/bin/drush cache:rebuild')
    - notContains: |
        >  The dump file dump.sql does not exist.

- command: 'toolkit:install-dump'
  configuration:
    toolkit:
      clone:
        dumpfile: 'new-dump.sql'
  expectations:
    - contains: |
        >  "new-dump.sql" file not found, use the command "toolkit:download-dump --dumpfile new-dump.sql".

- command: 'toolkit:download-dump'
  configuration:
    env:
      ASDA_USER: 'user-asda'
      ASDA_PASSWORD: 'user-password'
  expectations:
    - contains: |
       [Simulator] Simulating Exec('wget')
          ->option('--http-user', 'user-asda')
          ->option('--http-password', 'user-password')
          ->option('-O', 'dump.sql.gz')
          ->option('-nH', 'https://webgate.ec.europa.eu/fpfis/files-for/automate_dumps/PROJECTID')
          ->option('-A', 'sql.gz')
       [Simulator] Running wget --http-user user-asda --http-password user-password -O dump.sql.gz -nH 'https://webgate.ec.europa.eu/fpfis/files-for/automate_dumps/PROJECTID' -A sql.gz
       [Simulator] Simulating Exec('gunzip')
          ->arg('dump.sql.gz')
       [Simulator] Running gunzip dump.sql.gz

- command: 'toolkit:download-dump'
  configuration: []
  expectations:
    - contains: |
        >  ASDA credentials not found, set them as the following environment variables: ASDA_USER, ASDA_PASSWORD.
